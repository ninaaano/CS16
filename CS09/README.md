# CS09

# 함수형 Set

### 불변성

불변 클래스란 한번 초기화되면 상태를 변경할 수 없는 클래스이다. 즉 불변 객체의 인스턴스를 참조하고 있다면 해당 인스턴스에 대한 변경이 일어나면 새로운 객체를 생성해 새로운 메모리 공간으로 가리키도록 참조를 변경. chche, map, set등의 요소로 활용하기에 적합하다.

- 클래스는 확장이 불가능하도록 final 키워드를 붙인다. 자식 클래스를 인스턴스화 할 수 있으므로 원하지 않는 가변적인 구현을 할 수도 있기 때문
- 모든 속성필드는 캡슐화 원칙에 따라 private
- 불변 클래스 인스턴스를 올바르게 생성하기 위해 클래스 상태를 초기에 세팅할 수 있도록 매개변수가 있는 생성자가 있어야 한다
- 클래 속성 변경 가능성을 막기 위해 초기화 이후 setter 메서드를 포함하면 안된다
- 컬렉션 필드의 전체 복사본을 만들어 컬렉션 유형 필드의 상태 변경을 할수 없도록 해야한다

Reference를 가지고 있는 타입(object, array)은 실제 데이터는 힙 영역에 저장하고 그 힙영역을 가리키는 주솟값을 스택에서 가지고 있다

불변 객체는 가리키고 있는 주솟값 그리고 힙 영역에 있는 데이터 그 자체가 변경되지 않는 것을 의미한다. 이해가 잘 안되면 불변 객체 검색. String이나 StringBuilder를 사용하여 불변 객체를 설명하고 있는 자료 보기

- 원시 타입에서의 불변

원시 타입은 참조값이 존재하지 않기 때문에 값을 그대로 외부로 내보내는 경우에도 내부 객체는 불변이다. 따라서 Setter를 생성하지 않는 것만으로도 원시 타입으로 이루어진 객체는 불변으로 만들 수 있다

- 참조 타입에서의 불변

원시 타입이 아닌 참조 타입에서 불변은 조금 더 까다로운 형태로 불변 객체를 만들어야한다.

### 순수함수

- 동일 입력에는 항상 같은 값을 반환
- 함수의 리턴값을 오로지 input값에만 의존(참조 투명성)
- 함수 실행으로 인한 부수효과가 없어야 한다
- 부수효과?

  함수의 실행으로 함수 외부상태가 변경되는 것을 뜻한다.

    - 함수 외부 변수의 값이 변경됨
    - 예외나 오류로 인하여 프로그램 중단

### 함수형 프로그래밍

순수함수, 고차함수, 익명함수의 조건을 만족시켜야 함

단일 추상 메서드를 가지는 인터페이스

### 참조투명성

### 함수 합성

새로운 함수를 만들거나 계산하기 위해 둘 이상의 함수를 조합하는 것

### 고차함수

함수의 인자로 함수를 전달할 수 있다

함수의 리턴 값으로 함수를 사용할 수 있다

### 커링

여러개의 인자를 가진 함수를 호출할 경우 파라미터의 수보다 적은 수의 파라미터를 인자로 받으면서 누락된 파라미터를 인자로 받는 기법. 즉 함수 하나가 n개의 인자를 받는 과정을 n개의 함수로 각각의 인자를 받도록 하는것. 부분적으로 적용된 함수를 체인으로 계속 생성해 결과적으로 값을 처리하도록 하는 것이 본질

---

## 함수형 코드로 구현하기

### 구현

- 집합을 구현할 때 Array 혹은 List 배열만 사용하며, Object, HashMap이나 기존에 구현된 Set, HashSet 등 라이브러리는 사용할 수 없다.
    - 핵심 로직 대신 입력이나 출력용으로 Object나 Map 구조로 값을 전달하는 것은 가능하다.
- 각 클래스는 불변 클래스로 내부 속성을 바꾸지 않고, 변경될 경우는 새로운 집합을 리턴한다.

### **SquadSet**

- 불변 타입으로 초기화할 때만 배열로 값을 넘길 수 있다. 추가나 삭제는 되지 않는다.
- 수학에서 집합 개념을 지원하여, 요소가 중복되서는 안된다.
- **`sum(other)`** : SquadSet에 다른other SquadSet 요소들을 더해서 합집합을 리턴한다. 이미 같은 값이 있으면 추가하지 않는다.
- **`complement(other)`** : SquadSet에서 다른other SquadSet 요소를 빼서 차집합을 리턴한다. 값이 포함되어 있지 않으면 아무런 변화도 없다.
- **`intersect(other)`** : SquadSet와 다른other SquadSet 값과 비교해서, 두 집합에 모두 있는 원소 - 교집합을 리턴한다.
- **`resultAll()`** : 모든 요소를 1차원 배열로 리턴한다.

### **CountSet**

- 불변 타입으로 초기화할 때 Object 또는 HashMap으로 값을 넘길 수 있다.
    - 새로운 요소를 추가하거나 삭제하면 새로운 CountSet를 리턴한다.
- SquadSet과 달리 요소가 중복해서 있을 수 있고, 요소별 Count 값을 가지고 있다.
- **`append(element)`** : 새로운 요소를 추가하고 새로운 CountSet을 리턴한다. 이미 있는 경우는 Count만 증가하고 리턴한다.
- **`remove(element)`** : 기존에 요소가 있으면 Count를 줄인다. 만약 0이되면 제거한 CountSet을 리턴한다.
- **`countFor(element)`** : 특정 요소에 대한 Count 값을 리턴한다.
- **`sum(other)`** : CountSet에 다른other CountSet 요소들을 더해서 합집합을 리턴한다. 이미 같은 값이 있으면 합쳐서 카운트를 올린다.
- **`complement(other)`** : CountSet에서 다른other CountSet 요소를 빼서 차집합을 리턴한다. 값이 포함되어 있지 않으면 아무런 변화도 없다. 만약 현재 CountSet보다 빼려는 other CountSet 요소 Count가 더 큰 경우는 제거한다. (Count는 마이너스가 되지 않고 0보다 같거나 작으면 제거한다.)
- **`intersect(other)`** : Set와 다른other CountSet 값과 비교해서, 두 집합에 모두 있는 원소 - 교집합을 리턴한다. 교집합 Count는 모두 1로 리턴한다.
- **`resultAll()`** : 모든 요소와 Count를 Object 형태로 리턴한다.

---

# 고차함수 활용하기

### 기능요구사항

- 공통 사항으로 클로저(또는 람다)를 매개변수로 넘기기
- map() 메소드 추가
    - 전달한 클로저 조건에 맞춰 동일한 집합 클래스 생성해서 리턴
- ilter() 메소드 추가
    - 전달한 클로저 조건에 맞춰서 필터링된 집합 클래스 생성해서 리턴
- 출력을 위한 display() 메소드
    - 반복문 대신 reduce 활용해서 출력
    - display 내부에서 출력함수 호출하지말고, 전달하는 클로저 내부에서 처리하도록 구현
- map,filter,reduce처럼 고차함수로 동작하는 메소드 추가
    - 이전 단계와 구현한 집합 연산과 직접접으로 연관이 없는 동작 추가
- 커링 방식으로 함수 분해해서 구현. 합성해서 처리할 수 있는 함수를 스스로 찾아서 개선하거나 새로 추가
    - 이전 단계에서 구현한 집합 연산 개선